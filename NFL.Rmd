#| fig-width: 12
#| fig-height: 7.5

library(ggplot2)
library(grid)
library(png)

temp <- (360 / length(jackson_df$index)) / 2
myAng <- seq(-temp, -360 + temp, length.out = length(jackson_df$index))
ang <- ifelse(myAng < -90, myAng + 180, ang)
ang <- ifelse(ang < -90, ang + 180, ang)

# ✅ Load the image for Lamar Jackson
img <- readPNG("/Users/ericwentz/Desktop/COMP212/Activities/website/ericwentz5.github.io/young.png")

# ✅ Create the polar plot
p <- ggplot(data = young_df, aes(x = reorder(stat, index), y = percentile_value, label = percentile_value, fill = type)) +
  geom_bar(data = young_df, width = 1, color = "oldlace", stat = "identity") +
  coord_polar(clip = "off") +  
  geom_bar(aes(y=100, fill=type), stat="identity", width=1, alpha=0.5) +
  geom_hline(yintercept = seq(0, 100, by = 100), color = "oldlace", linewidth = 1) +
  geom_vline(xintercept = seq(.5, 12, by = 1), color = "oldlace", linewidth = .5) +
  geom_label(color = "gray20", fill = "oldlace", size=2.5, fontface="bold", family = "Comic Sans MS", show.legend = FALSE) +
  scale_fill_manual(values=c(color16, color17, color18)) +
  theme(
    legend.position = "top",
    legend.direction = "horizontal",
    legend.background = element_rect(fill = "oldlace", color="oldlace"),
    legend.title = element_blank(),
    legend.text = element_text(colour = "gray20", family = "Comic Sans MS", face = "bold"),
    legend.key.size = unit(.5, "cm"),
    legend.box.spacing = unit(0, "mm"),
    plot.title = element_text(hjust = .5, colour = "gray20", face = "bold", size = 16, family = "Comic Sans MS"),
    plot.subtitle = element_text(hjust = .5, colour = "gray20", size = 8, family = "Comic Sans MS"),
    plot.background = element_rect(fill = "oldlace", color="oldlace"),
    panel.background = element_rect(fill = "oldlace", color="oldlace"),
    panel.grid = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_text(face = "bold", size = 6.8, colour = "gray20"),
    axis.title = element_blank(),
    axis.text.x = element_text(face = "bold", size = 9, family = "Comic Sans MS", angle = 35)
  ) +
  labs(title = "Bryce Young",
       subtitle = "@EricWentz // 2023 Season // via: NFLFastR", x = NULL, y = NULL)

# ✅ First, print the plot so it appears in the background
grid.newpage()  # Create a new plotting page
print(p, newpage = FALSE)  # Print the ggplot first

# ✅ Then, overlay the image on top (so it stays visible)
grid.raster(img, x = 0.31, y = 0.85, width = 0.12)  # Adjust x, y, width
